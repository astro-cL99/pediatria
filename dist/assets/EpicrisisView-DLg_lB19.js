import{aM as u,l as w,j as s,$ as j,aC as y,au as _,m as a,o as i,p as r,n,aj as l,_ as o,s as p,ak as h}from"./index-CHTwuzBj.js";import{u as v}from"./useQuery-BmdVUKZ_.js";function E(){const{id:m}=u(),g=w(),{data:e,isLoading:N}=v({queryKey:["epicrisis",m],queryFn:async()=>{const{data:c,error:d}=await p.from("epicrisis").select("*").eq("id",m).single();if(d)throw d;return c}}),f=async()=>{if(!(e!=null&&e.pdf_file_path)){o.error("No hay PDF disponible para descargar");return}try{const{data:c,error:d}=await p.storage.from("medical-documents").download(e.pdf_file_path);if(d)throw d;const x=URL.createObjectURL(c),t=document.createElement("a");t.href=x,t.download=`epicrisis_${e.patient_rut}_${l(new Date(e.discharge_date),"yyyy-MM-dd")}.pdf`,t.click(),URL.revokeObjectURL(x),o.success("PDF descargado exitosamente")}catch(c){console.error("Error downloading PDF:",c),o.error("Error al descargar el PDF")}};return N?s.jsx("div",{className:"container mx-auto py-6",children:s.jsx("div",{className:"text-center",children:"Cargando epicrisis..."})}):e?s.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(j,{variant:"ghost",onClick:()=>g("/epicrisis"),children:[s.jsx(y,{className:"mr-2 h-4 w-4"}),"Volver"]}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold",children:["Epicrisis - ",e.patient_name]}),s.jsxs("p",{className:"text-muted-foreground",children:["RUT: ",e.patient_rut]})]})]}),e.pdf_file_path&&s.jsxs(j,{onClick:f,children:[s.jsx(_,{className:"mr-2 h-4 w-4"}),"Descargar PDF"]})]}),s.jsxs("div",{className:"grid gap-6",children:[s.jsxs(a,{children:[s.jsx(i,{children:s.jsx(r,{children:"Información del Paciente"})}),s.jsxs(n,{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Nombre:"})," ",e.patient_name]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"RUT:"})," ",e.patient_rut]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Fecha Nacimiento:"})," ",l(new Date(e.date_of_birth),"dd/MM/yyyy",{locale:h})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Edad al Egreso:"})," ",e.age_at_discharge]})]})]}),s.jsxs(a,{children:[s.jsx(i,{children:s.jsx(r,{children:"Datos de Hospitalización"})}),s.jsxs(n,{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Fecha Ingreso:"})," ",l(new Date(e.admission_date),"dd/MM/yyyy HH:mm",{locale:h})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Peso Ingreso:"})," ",e.admission_weight?`${e.admission_weight} kg`:"N/A"]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Fecha Egreso:"})," ",l(new Date(e.discharge_date),"dd/MM/yyyy HH:mm",{locale:h})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Peso Egreso:"})," ",e.discharge_weight?`${e.discharge_weight} kg`:"N/A"]})]})]}),s.jsxs(a,{children:[s.jsx(i,{children:s.jsx(r,{children:"Diagnósticos"})}),s.jsxs(n,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Diagnóstico de Ingreso:"}),s.jsx("p",{className:"mt-2 whitespace-pre-wrap",children:e.admission_diagnosis})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Diagnóstico de Egreso:"}),s.jsx("p",{className:"mt-2 whitespace-pre-wrap",children:e.discharge_diagnosis})]})]})]}),s.jsxs(a,{children:[s.jsx(i,{children:s.jsx(r,{children:"Evolución y Tratamiento"})}),s.jsx(n,{children:s.jsx("p",{className:"whitespace-pre-wrap",children:e.evolution_and_treatment})})]}),s.jsxs(a,{children:[s.jsx(i,{children:s.jsx(r,{children:"Exámenes Realizados"})}),s.jsxs(n,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Laboratorios:"}),s.jsx("p",{className:"mt-2 whitespace-pre-wrap",children:e.laboratory_exams||"No se realizaron exámenes de laboratorio"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Imagenología:"}),s.jsx("p",{className:"mt-2 whitespace-pre-wrap",children:e.imaging_exams||"No se realizaron estudios imagenológicos"})]})]})]}),s.jsxs(a,{children:[s.jsx(i,{children:s.jsx(r,{children:"Indicaciones al Alta"})}),s.jsxs(n,{children:[s.jsx("p",{className:"whitespace-pre-wrap",children:e.discharge_instructions}),s.jsxs("div",{className:"mt-4",children:[s.jsx("span",{className:"font-semibold",children:"Médico Tratante:"})," ",e.attending_physician]})]})]})]})]}):s.jsx("div",{className:"container mx-auto py-6",children:s.jsx("div",{className:"text-center",children:"Epicrisis no encontrada"})})}export{E as default};
